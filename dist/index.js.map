{"version":3,"file":"index.js","sources":["../index.ts"],"sourcesContent":["type Options = {\r\n  openDelimiter: string;\r\n  closeDelimiter: string;\r\n  plugins?: {\r\n    name: string;\r\n    delimiter: string;\r\n    fn: (content: string) => string;\r\n  }[];\r\n};\r\n\r\nconst defaultOptions: Options = {\r\n  openDelimiter: \"{{\",\r\n  closeDelimiter: \"}}\",\r\n};\r\n\r\nconst defaultPlugins: Options[\"plugins\"] = [\r\n  {\r\n    name: \"return\",\r\n    delimiter: \"=\",\r\n    fn: function (content) {\r\n      return \"return \" + content;\r\n    },\r\n  },\r\n  {\r\n    name: \"comment\",\r\n    delimiter: \"#\",\r\n    fn: function (content) {\r\n      return \"/*\" + content + \"*/\";\r\n    },\r\n  },\r\n];\r\n\r\nfunction tempjs(\r\n  template: string,\r\n  data: Record<string, unknown>,\r\n  opts: Options = defaultOptions\r\n): string {\r\n  //custom plugin to add fatest return\r\n  opts.plugins = (opts.plugins ?? []).concat(defaultPlugins);\r\n\r\n  const delimiterRegex = new RegExp(\r\n    opts.openDelimiter + \"([\\\\s\\\\S]*?)\" + opts.closeDelimiter,\r\n    \"gi\"\r\n  );\r\n\r\n  const result: string[] = [];\r\n\r\n  const templateText = template.split(\r\n    new RegExp(opts.openDelimiter + \"[\\\\s\\\\S]*?\" + opts.closeDelimiter, \"gi\")\r\n  );\r\n\r\n  let match: RegExpExecArray;\r\n  while ((match = delimiterRegex.exec(template)) !== null) {\r\n    const jsInstruction = match[1];\r\n    const text = JSON.stringify(templateText.shift());\r\n\r\n    let finalJsInstruction = jsInstruction;\r\n\r\n    const customPlugin = opts.plugins.find((plugin) =>\r\n      jsInstruction.startsWith(plugin.delimiter)\r\n    );\r\n\r\n    if (customPlugin) {\r\n      finalJsInstruction = customPlugin.fn(\r\n        jsInstruction.replace(customPlugin.delimiter, \"\")\r\n      );\r\n    }\r\n\r\n    result.push(\r\n      (text ? text + \"+\" : \"\") + `((function(){ ${finalJsInstruction} })()??\"\")`\r\n    );\r\n  }\r\n\r\n  const code =\r\n    \"return \" +\r\n    result.join(\" + \") +\r\n    (templateText.length > 0 ? \"+\" + JSON.stringify(templateText.shift()) : \"\");\r\n  return new Function(...Object.keys(data), code).apply(\r\n    null,\r\n    Object.values(data)\r\n  );\r\n}\r\n\r\nexport default tempjs;\r\n"],"names":[],"mappings":";;;;;;EAUA,MAAM,cAAc,GAAY;EAC9B,IAAA,aAAa,EAAE,IAAI;EACnB,IAAA,cAAc,EAAE,IAAI;GACrB,CAAC;EAEF,MAAM,cAAc,GAAuB;EACzC,IAAA;EACE,QAAA,IAAI,EAAE,QAAQ;EACd,QAAA,SAAS,EAAE,GAAG;UACd,EAAE,EAAE,UAAU,OAAO,EAAA;cACnB,OAAO,SAAS,GAAG,OAAO,CAAC;WAC5B;EACF,KAAA;EACD,IAAA;EACE,QAAA,IAAI,EAAE,SAAS;EACf,QAAA,SAAS,EAAE,GAAG;UACd,EAAE,EAAE,UAAU,OAAO,EAAA;EACnB,YAAA,OAAO,IAAI,GAAG,OAAO,GAAG,IAAI,CAAC;WAC9B;EACF,KAAA;GACF,CAAC;EAEF,SAAS,MAAM,CACb,QAAgB,EAChB,IAA6B,EAC7B,OAAgB,cAAc,EAAA;;;EAG9B,IAAA,IAAI,CAAC,OAAO,GAAG,CAAC,CAAA,EAAA,GAAA,IAAI,CAAC,OAAO,MAAI,IAAA,IAAA,EAAA,KAAA,KAAA,CAAA,GAAA,EAAA,GAAA,EAAE,EAAE,MAAM,CAAC,cAAc,CAAC,CAAC;EAE3D,IAAA,MAAM,cAAc,GAAG,IAAI,MAAM,CAC/B,IAAI,CAAC,aAAa,GAAG,cAAc,GAAG,IAAI,CAAC,cAAc,EACzD,IAAI,CACL,CAAC;MAEF,MAAM,MAAM,GAAa,EAAE,CAAC;MAE5B,MAAM,YAAY,GAAG,QAAQ,CAAC,KAAK,CACjC,IAAI,MAAM,CAAC,IAAI,CAAC,aAAa,GAAG,YAAY,GAAG,IAAI,CAAC,cAAc,EAAE,IAAI,CAAC,CAC1E,CAAC;EAEF,IAAA,IAAI,KAAsB,CAAC;EAC3B,IAAA,OAAO,CAAC,KAAK,GAAG,cAAc,CAAC,IAAI,CAAC,QAAQ,CAAC,MAAM,IAAI,EAAE;EACvD,QAAA,MAAM,aAAa,GAAG,KAAK,CAAC,CAAC,CAAC,CAAC;UAC/B,MAAM,IAAI,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,KAAK,EAAE,CAAC,CAAC;UAElD,IAAI,kBAAkB,GAAG,aAAa,CAAC;UAEvC,MAAM,YAAY,GAAG,IAAI,CAAC,OAAO,CAAC,IAAI,CAAC,CAAC,MAAM,KAC5C,aAAa,CAAC,UAAU,CAAC,MAAM,CAAC,SAAS,CAAC,CAC3C,CAAC;EAEF,QAAA,IAAI,YAAY,EAAE;EAChB,YAAA,kBAAkB,GAAG,YAAY,CAAC,EAAE,CAClC,aAAa,CAAC,OAAO,CAAC,YAAY,CAAC,SAAS,EAAE,EAAE,CAAC,CAClD,CAAC;EACH,SAAA;UAED,MAAM,CAAC,IAAI,CACT,CAAC,IAAI,GAAG,IAAI,GAAG,GAAG,GAAG,EAAE,IAAI,CAAiB,cAAA,EAAA,kBAAkB,CAAY,UAAA,CAAA,CAC3E,CAAC;EACH,KAAA;MAED,MAAM,IAAI,GACR,SAAS;EACT,QAAA,MAAM,CAAC,IAAI,CAAC,KAAK,CAAC;WACjB,YAAY,CAAC,MAAM,GAAG,CAAC,GAAG,GAAG,GAAG,IAAI,CAAC,SAAS,CAAC,YAAY,CAAC,KAAK,EAAE,CAAC,GAAG,EAAE,CAAC,CAAC;MAC9E,OAAO,IAAI,QAAQ,CAAC,GAAG,MAAM,CAAC,IAAI,CAAC,IAAI,CAAC,EAAE,IAAI,CAAC,CAAC,KAAK,CACnD,IAAI,EACJ,MAAM,CAAC,MAAM,CAAC,IAAI,CAAC,CACpB,CAAC;EACJ;;;;;;;;"}